<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: gap: content:">
    <title>üìä PollSocial Pro</title>
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div class="app-container">
        <div class="navbar" id="navbar" style="display: none;">
            <h1 onclick="showFeed()">üìä PollSocial Pro</h1>
            <div class="nav-icons">
                <div class="nav-icon" onclick="toggleSearch()">üîç</div>
                <div class="nav-icon" onclick="alert('–°–æ–æ–±—â–µ–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">üí¨</div>
                <div class="nav-icon" onclick="showProfile()">
                    <span id="navAvatar">U</span>
                </div>
            </div>
        </div>

        <div id="loginScreen" class="screen active">
            <div class="login-container">
                <h1>üìä PollSocial Pro</h1>
                <input type="text" id="serverUrl" placeholder="–ê–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞" value="http://YOUR_SERVER_IP:3000">
                <input type="email" id="loginEmail" placeholder="Email" value="">
                <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" value="">
                <button onclick="login()">–í–æ–π—Ç–∏</button>
                <button class="secondary-btn" style="margin-top: 10px;" onclick="showRegister()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
        </div>

        <div id="registerScreen" class="screen">
            <div class="login-container">
                <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
                <input type="text" id="regUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                <input type="email" id="regEmail" placeholder="Email">
                <input type="password" id="regPassword" placeholder="–ü–∞—Ä–æ–ª—å">
                <textarea id="regBio" placeholder="–û —Å–µ–±–µ" rows="3"></textarea>
                <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <button class="secondary-btn" style="margin-top: 10px;" onclick="showLogin()">–ù–∞–∑–∞–¥</button>
            </div>
        </div>

        <div id="mainScreen" class="screen">
            <div id="searchContainer">
                <input type="text" id="userSearch" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π..." oninput="searchUsers(this.value, 'all')">
                <select id="searchFilter" onchange="searchUsers(document.getElementById('userSearch').value, this.value)">
                    <option value="all">–í—Å–µ</option>
                    <option value="followers">–ú–æ–∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏</option>
                    <option value="following">–ú–æ–∏ –ø–æ–¥–ø–∏—Å–∫–∏</option>
                </select>
                <div id="searchResults"></div>
            </div>
            <div id="userSuggestions"></div>
            
            <div class="content">
                <div class="user-profile">
                    <div class="user-avatar" id="userAvatar"></div>
                    <div class="user-info">
                        <h3 id="userName"></h3>
                        <p>–†–µ–π—Ç–∏–Ω–≥: <span id="userRating">0</span> ‚≠ê | –ú–æ–Ω–µ—Ç: <span id="userCoins">1000</span> ü™ô</p>
                    </div>
                </div>

                <div class="tabs">
                    <div class="tab active" onclick="switchTab('active', event)">üî• –ê–∫—Ç–∏–≤–Ω—ã–µ</div>
                    <div class="tab" onclick="switchTab('history', event)">üìú –ò—Å—Ç–æ—Ä–∏—è</div>
                    <div class="tab" onclick="switchTab('results', event)">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</div>
                </div>

                <div class="my-bets-section" id="myBetsSection" style="display: none;">
                    <h3 style="font-size: 14px; color: #666; margin-bottom: 10px;">üé≤ –ú–æ–∏ —Å—Ç–∞–≤–∫–∏</h3>
                    <div id="myBetsList"></div>
                </div>

                <div id="activeContent" class="tab-content">
                    <div class="feed-filters">
                        <button class="filter-btn active" onclick="changeFilter('all', event)">–í—Å–µ</button>
                        <button class="filter-btn" onclick="changeFilter('following', event)">–ü–æ–¥–ø–∏—Å–∫–∏</button>
                        <button class="filter-btn" onclick="changeFilter('popular', event)">–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ</button>
                    </div>
                    <div class="feed" id="pollsFeed"></div>
                </div>

                <div id="historyContent" class="tab-content" style="display: none;">
                    <div class="stats-grid">
                        <div class="stat-card"><div class="stat-value" id="totalPolls">0</div><div class="stat-label">–í—Å–µ–≥–æ –æ–ø—Ä–æ—Å–æ–≤</div></div>
                        <div class="stat-card"><div class="stat-value" id="totalVotes">0</div><div class="stat-label">–í—Å–µ–≥–æ –≥–æ–ª–æ—Å–æ–≤</div></div>
                        <div class="stat-card"><div class="stat-value" id="wonBets">0</div><div class="stat-label">–í—ã–∏–≥—Ä—ã—à–µ–π</div></div>
                        <div class="stat-card"><div class="stat-value" id="totalWinnings">0 ü™ô</div><div class="stat-label">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div></div>
                    </div>
                    <h3 style="font-size: 14px; color: #666; margin: 15px 0 10px 0;">üé≤ –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫</h3>
                    <div id="betsHistoryList"></div>
                    <div id="historyList"></div>
                </div>

                <div id="resultsContent" class="tab-content" style="display: none;">
                    <div class="feed-filters">
                        <button class="filter-btn active" onclick="filterResults('all', event)">–í—Å–µ</button>
                        <button class="filter-btn" onclick="filterResults('won', event)">–í—ã–∏–≥—Ä–∞–ª</button>
                        <button class="filter-btn" onclick="filterResults('lost', event)">–ü—Ä–æ–∏–≥—Ä–∞–ª</button>
                    </div>
                    <div id="resultsList"></div>
                </div>
            </div>
        </div>

        <div id="profileScreen" class="screen">
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px 20px; color: white; text-align: center;">
                <div style="width: 80px; height: 80px; border-radius: 50%; background: white; color: #667eea; display: flex; align-items: center; justify-content: center; font-size: 32px; font-weight: bold; margin: 0 auto 15px; border: 3px solid white;" id="profilePageAvatar">U</div>
                <div style="font-size: 20px; font-weight: bold; margin-bottom: 5px;" id="profilePageUsername">Username</div>
                <div style="font-size: 13px; opacity: 0.9; margin-bottom: 15px;" id="profilePageBio">Bio</div>
                <div style="display: flex; justify-content: center; gap: 25px; margin-top: 15px;">
                    <div style="text-align: center;"><div style="font-size: 18px; font-weight: bold;" id="profilePagePolls">0</div><div style="font-size: 11px; opacity: 0.9;">–û–ø—Ä–æ—Å–æ–≤</div></div>
                    <div style="text-align: center;"><div style="font-size: 18px; font-weight: bold;" id="profilePageFollowers">0</div><div style="font-size: 11px; opacity: 0.9;">–ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div></div>
                    <div style="text-align: center;"><div style="font-size: 18px; font-weight: bold;" id="profilePageRating">0</div><div style="font-size: 11px; opacity: 0.9;">–†–µ–π—Ç–∏–Ω–≥ ‚≠ê</div></div>
                    <div style="text-align: center;"><div style="font-size: 18px; font-weight: bold;" id="profilePageCoins">0</div><div style="font-size: 11px; opacity: 0.9;">–ú–æ–Ω–µ—Ç ü™ô</div></div>
                </div>
            </div>
            <div style="padding: 15px; display: flex; gap: 10px; background: white;">
                <button style="flex: 1; background: #f5f5f5; color: #667eea;" onclick="editProfile()">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button style="flex: 1; background: #f44336;" onclick="logout()">‚éã –í—ã–π—Ç–∏</button>
            </div>
            <div style="padding: 15px;"><h3 style="margin-bottom: 15px;">–ú–æ–∏ –æ–ø—Ä–æ—Å—ã</h3><div id="profilePagePollsList"></div></div>
            <button class="floating-btn" onclick="showFeed()">‚Üê</button>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
        <div id="commentsModal" class="modal" onclick="if(event.target===this) closeModal('commentsModal')">
            <div class="modal-content">
                <div class="modal-header"><h2>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h2><button class="modal-close" onclick="closeModal('commentsModal')">√ó</button></div>
                <div id="commentsList"></div>
                <textarea id="newComment" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." rows="3"></textarea>
                <button onclick="addComment()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>

        <div id="createPollModal" class="modal" onclick="if(event.target===this) closeModal('createPollModal')">
            <div class="modal-content">
                <div class="modal-header"><h2>‚ûï –°–æ–∑–¥–∞—Ç—å –æ–ø—Ä–æ—Å</h2><button class="modal-close" onclick="closeModal('createPollModal')">√ó</button></div>
                <input type="text" id="pollTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞">
                <textarea id="pollDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" rows="3"></textarea>
                <select id="pollCategory"><option>–û–±—â–µ–µ</option><option>–°–ø–æ—Ä—Ç</option><option>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option><option>–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option><option>–ü–æ–ª–∏—Ç–∏–∫–∞</option></select>
                <label style="font-size: 14px; font-weight: 600; margin: 10px 0 5px 0; display: block;">üîí –í–∏–¥–∏–º–æ—Å—Ç—å –æ–ø—Ä–æ—Å–∞</label>
                <select id="pollVisibility" onchange="handleVisibilityChange()">
                    <option value="public">üåç –ü—É–±–ª–∏—á–Ω—ã–π - –í–∏–¥—è—Ç –≤—Å–µ</option>
                    <option value="followers">üë• –¢–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏</option>
                    <option value="selected">üéØ –í—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</option>
                </select>
                <div id="selectedUsersContainer" style="display: none; margin: 10px 0;">
                    <button type="button" class="secondary-btn" onclick="openUserSelector()" style="width: 100%; margin-bottom: 10px;">üë• –í—ã–±—Ä–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (<span id="selectedUsersCount">0</span>)</button>
                    <div id="selectedUsersList" style="font-size: 12px; color: #666;"></div>
                </div>
                <label><input type="checkbox" id="allowBetting" style="width: auto; margin-right: 8px;"> –†–∞–∑—Ä–µ—à–∏—Ç—å —Å—Ç–∞–≤–∫–∏</label>
                <div id="optionsList">
                    <div class="input-group"><label>–í–∞—Ä–∏–∞–Ω—Ç 1</label><input type="text" class="option-input" placeholder="–ü–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç"></div>
                    <div class="input-group"><label>–í–∞—Ä–∏–∞–Ω—Ç 2</label><input type="text" class="option-input" placeholder="–í—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç"></div>
                </div>
                <button class="secondary-btn" onclick="addOption()">+ –î–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç</button>
                <button onclick="createPoll()">–°–æ–∑–¥–∞—Ç—å –æ–ø—Ä–æ—Å</button>
            </div>
        </div>

        <div id="betModal" class="modal" onclick="if(event.target===this) closeModal('betModal')">
            <div class="modal-content">
                <div class="modal-header"><h2>üé≤ –°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</h2><button class="modal-close" onclick="closeModal('betModal')">√ó</button></div>
                <div class="coins-display">–î–æ—Å—Ç—É–ø–Ω–æ: <span id="modalCoins">1000</span> ü™ô</div>
                <div id="betOptions"></div>
                <label style="margin-top: 15px;">–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="quick-amounts">
                    <button class="quick-amount-btn" onclick="setQuickAmount(10)">10 ü™ô</button>
                    <button class="quick-amount-btn" onclick="setQuickAmount(50)">50 ü™ô</button>
                    <button class="quick-amount-btn" onclick="setQuickAmount(100)">100 ü™ô</button>
                </div>
                <input type="number" id="betAmount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="1">
                <button onclick="placeBet()">–ü–æ—Å—Ç–∞–≤–∏—Ç—å</button>
            </div>
        </div>

        <div id="userProfileModal" class="modal" onclick="if(event.target===this) closeModal('userProfileModal')"><div class="modal-content"></div></div>
        <div id="userSelectorModal" class="modal" onclick="if(event.target===this) closeModal('userSelectorModal')">
            <div class="modal-content">
                <div class="modal-header"><h2>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2><button class="modal-close" onclick="closeModal('userSelectorModal')">√ó</button></div>
                <input type="text" id="userSelectorSearch" placeholder="–ü–æ–∏—Å–∫..." oninput="searchUsersForSelector(this.value)">
                <div id="userSelectorList"></div>
                <button onclick="confirmUserSelection()">–ì–æ—Ç–æ–≤–æ</button>
            </div>
        </div>
        <div id="followersModal" class="modal" onclick="if(event.target===this) closeModal('followersModal')">
            <div class="modal-content">
                <div class="modal-header"><h2 id="followersModalTitle"></h2><button class="modal-close" onclick="closeModal('followersModal')">√ó</button></div>
                <div id="followersModalContent"></div>
            </div>
        </div>

        <button class="floating-btn" onclick="openCreatePoll()" id="mainFab">+</button>
    </div>

    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
</body>
</html>
